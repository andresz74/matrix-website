<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />

	<!-- Facebook Meta Tags -->
	<meta property="og:title" content="Matrix Falling Code with Multi-Layered Canvases" />
	<meta property="og:description"
		content="Create a visually stunning Matrix rain animation using HTML5 Canvas, JavaScript, and CSS. Add gradients, unique trails, and interactive effects to bring your code to life!" />
	<meta property="og:type" content="website" />
	<meta property="og:url" content="https://matrix.andreszenteno.com" />
	<meta property="og:image" content="https://zenteno.org/public_assets/matrix-rain-2.png" />
	<meta property="og:image:alt" content="Screenshot of a Matrix falling code animation with colorful gradients." />
	<meta property="og:locale" content="en_US" />
	<meta property="og:site_name" content="Matrix Rain Animations" />
	<!-- Twitter Meta Tags -->
	<meta name="twitter:card" content="summary_large_image" />
	<meta property="twitter:domain" content="matrix.andreszenteno.com" />
	<meta property="twitter:url" content="https://matrix.andreszenteno.com" />
	<meta name="twitter:title" content="Matrix Falling Code with Multi-Layered Canvases" />
	<meta name="twitter:description"
		content="Create a visually stunning Matrix rain animation using HTML5 Canvas, JavaScript, and CSS. Add gradients, unique trails, and interactive effects to bring your code to life!" />
	<meta name="twitter:image" content="https://zenteno.org/public_assets/matrix-rain-2.png" />

	<title>Matrix Falling Code with Multi-Layered Canvases</title>
	<link rel="stylesheet" href="/assets/css/fontawesome.min.css" />
	<link rel="stylesheet" href="/assets/css/brands.min.css" />
	<link rel="stylesheet" href="/assets/css/solid.min.css" />
	<link rel="stylesheet" href="/assets/css/style.css" media="screen" type="text/css" />
	<style>
		body,
		html {
			margin: 0;
			padding: 0;
			overflow: hidden;
		}

		/* Stack canvases on top of each other */
		canvas {
			position: absolute;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			display: block;
		}

		#matrixCanvas1 {
			z-index: 1;
		}

		#matrixCanvas2 {
			z-index: 2;
		}

		#matrixCanvas3 {
			z-index: 3;
		}

		#overlayCanvas {
			z-index: 4;
		}

		.blur {
			filter: blur(4px);
			transition: filter 0.5s ease-in-out;
		}

		.opacity-4 {
			opacity: 0.4;
			transition: opacity 0.5s ease-in-out;
		}

		.opacity-8 {
			opacity: 0.8;
			transition: opacity 0.5s ease-in-out;
		}
	</style>
</head>

<body>
	<div id="matrixContainer">
		<div id="header-placeholder" class="header"></div>
		<div class="centered-box">
			<div id="body-wrapper"></div>
		</div>
		<div id="footer-placeholder" class="footer"></div>
	</div>
	<!-- First Layer -->
	<canvas id="matrixCanvas1"></canvas>
	<!-- Second Layer -->
	<canvas id="matrixCanvas2" class="opacity-8"></canvas>
	<!-- Third Layer -->
	<canvas id="matrixCanvas3" class="blur opacity-4"></canvas>
	<!-- Foreground Canvas -->
	<canvas id="overlayCanvas" class="blur opacity-4"></canvas>
	<script src="matrix.js"></script>
	<script type="module">
		const loadFragment = async (id, file) => {
			const res = await fetch(file);
			const html = await res.text();
			document.getElementById(id).innerHTML = html;

			// If it's the header, bind mobile menu toggle
			if (id === "header-placeholder") {
				const toggle = document.getElementById("menu-toggle");
				const nav = document.getElementById("main-nav");

				if (toggle && nav) {
					toggle.addEventListener("click", () => {
						nav.classList.toggle("open");
					});

					// Close menu when any link inside nav is clicked
					nav.querySelectorAll("a").forEach((link) => {
						link.addEventListener("click", () => {
							nav.classList.remove("open");
						});
					});
				}
			}
		};

		// Initial header/footer load
		loadFragment("header-placeholder", "components/header.html");
		loadFragment("footer-placeholder", "components/footer.html");

		function loadGallery() {
			const gallery = document.getElementById('gallery-collage');
			if (gallery) {
				gallery.innerHTML = ''; // Clear existing content
				const images = [
					{ name: 'TheMatrix_00001', orientation: 'portrait' },
					{ name: 'TheMatrix_00002', orientation: 'landscape' },
					{ name: 'TheMatrix_00003', orientation: 'landscape' },
					{ name: 'TheMatrix_00004', orientation: 'landscape' },
					{ name: 'TheMatrix_00005', orientation: 'landscape' },
					{ name: 'TheMatrix_00006', orientation: 'landscape' },
					{ name: 'TheMatrix_00007', orientation: 'landscape' },
					{ name: 'TheMatrix_00008', orientation: 'landscape' },
					{ name: 'TheMatrix_00009', orientation: 'landscape' },
					{ name: 'TheMatrix_00010', orientation: 'landscape' },
					{ name: 'TheMatrix_00011', orientation: 'landscape' },
					{ name: 'TheMatrix_00012', orientation: 'portrait' },
					{ name: 'TheMatrix_00013', orientation: 'portrait' },
					{ name: 'TheMatrix_00014', orientation: 'landscape' },
					{ name: 'TheMatrix_00015', orientation: 'landscape' },
					{ name: 'TheMatrix_00016', orientation: 'landscape' },
					{ name: 'TheMatrix_00017', orientation: 'landscape' },
					{ name: 'TheMatrix_00018', orientation: 'landscape' },
					{ name: 'TheMatrix_00019', orientation: 'landscape' },
					{ name: 'TheMatrix_00020', orientation: 'landscape' },
					{ name: 'TheMatrix_00021', orientation: 'landscape' },
					{ name: 'TheMatrix_00022', orientation: 'landscape' },
					{ name: 'TheMatrix_00023', orientation: 'landscape' },
					{ name: 'TheMatrix_00024', orientation: 'landscape' },
					{ name: 'TheMatrix_00025', orientation: 'landscape' },
					{ name: 'TheMatrix_00026', orientation: 'landscape' },
					{ name: 'TheMatrix_00027', orientation: 'landscape' },
					{ name: 'TheMatrix_00028', orientation: 'landscape' },
					{ name: 'TheMatrix_00029', orientation: 'landscape' },
					{ name: 'TheMatrix_00030', orientation: 'landscape' },
					{ name: 'TheMatrix_00031', orientation: 'portrait' },
					{ name: 'TheMatrix_00032', orientation: 'portrait' },
					{ name: 'TheMatrix_00033', orientation: 'portrait' },
					{ name: 'TheMatrix_00034', orientation: 'landscape' },
					{ name: 'TheMatrix_00035', orientation: 'landscape' },
					{ name: 'TheMatrix_00036', orientation: 'landscape' },
					{ name: 'TheMatrix_00037', orientation: 'landscape' },
					{ name: 'TheMatrix_00038', orientation: 'landscape' }
				];

				images.forEach(({ name, orientation }) => {
					const anchor = document.createElement('a');
					anchor.href = `assets/images/${name}.jpg`;
					anchor.target = '_blank';

					const img = document.createElement('img');
					img.src = `assets/images/thumbs/${name}.jpg`;
					img.alt = name;
					img.className = orientation;

					anchor.appendChild(img);
					gallery.appendChild(anchor);
				});
			}
		}

		// Load dynamic body content (e.g., About page)
		window.loadPage = async function (file, title = "", url = "") {
			const res = await fetch(file);
			const html = await res.text();
			document.getElementById("body-wrapper").innerHTML = html;

			if (title) document.title = title;
			if (url) history.pushState({ file, title }, title, url);
			if (file === "pages/gallery.html") {
				loadGallery();
			}
		};

		window.onpopstate = async function (event) {
			if (event.state) {
				const { file, title } = event.state;
				const res = await fetch(file);
				const html = await res.text();
				document.getElementById("body-wrapper").innerHTML = html;
				if (title) document.title = title;
			}
		};

		const path = window.location.pathname;
		switch (path) {
			case "/videos":
				loadPage("pages/videos.html", "Videos", "/videos");
				break;
			case "/soundtrack":
				loadPage("pages/soundtrack.html", "Soundtrack", "/soundtrack");
				break;
			case "/synopsis":
				loadPage("pages/synopsis.html", "Synopsis", "/synopsis");
				break;
			case "/gallery":
				loadPage("pages/gallery.html", "Gallery", "/gallery");
				break;
			case "/":
			default:
				loadPage("pages/home.html", "Home", "/");
				break;
		}
	</script>
</body>

</html>